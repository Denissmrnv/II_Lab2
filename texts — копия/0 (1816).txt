играем музыку системном динамике вчера играем музыку системном динамике ненормальное программирование  компьютерное железо сделай песочницы   предисловие  привет мир  года хочу написать хабр никак находилось темы которую накатать пост тех пор пока понадобилось узнать немного работу системного таймера системного динамика лабораторной работы порыскав немного интернете нашел дельного написано слишком сложным языком особо содержательно обзавелся неплохой книгой целой ночью попытался сыграть всеми известную тему игры марио продолжение прямо катом вроде заведено   дисклеймер  код написан написан автор гений программирования лишь студент менее попытался написать максимально читаемый понятный код вс написано протестировано установленного доса очень хочется напортачить часами реального времени  далеком году написал крутую версию показалось мало внимания уделил теории  автор т е имеет года музыкального образования плох сольфеджио музыкальная грамота   немного теории  давным давно популярен процессор вызывало вопросов самые совместимых компьютерах использовался таймер счетчик интервалов современных компьютерах этим занимается южный мост источник  примерная логическая схема      видеть изображении выше таймер подключен линии вырабатывает прерывание секунду  таймер состоит счетчиков которые работают независимо друг друга  это странно каждый счетчик выполняет работу современных компьютерах первый канал считает время суток помощью второго канала происходит регенерация помощью третьего канала сделать псевдослучайный генератор чисел пиликать системным динамиком  каждый канал имеет режимов работы   режим прерывание терминального счета режим программируемый ждущий мультивибратор режим импульсный генератор частоты режим генератор меандра режим программно формируемый строб режим аппаратно формируемый строб   переходим делу  итак узнали немного теории системном таймере узнали третий канал подключен системному динамику вроде вс классно помощью сыграть тему марио пока понятно  каждый счетчик канал программируется отдельно решили нужно использовать третий видно изображении выше динамик соедин н выходом время соединен портом помощью которого можем управлять динамиком первый младший бит подключен входу определяет работает счетчик второй бит запускает динамик  исходя теории становится понятен фронт работы проигрывания звука   программируем нужную нам частоту позже помощью первых двух бит включить динамик  дефолтный системный динамик воспроизводить одноголосые звуки это старых кнопочных телефонах бумер наигрывали нам нужно получить частоту каждой ноты   таблица соотношений нот частот   увидеть таблицы повысить понизить октаву нужно просто умножить поделить значение частоты   установить нужную частоту нашего сч тчика нужно воспользоваться определенной формулой гц частота таймера мгц правильным частота ноты которую решили вывести динамик     функция ужасного простая честно говоря плохо оптимизированная сути дела это меняет      нашим марио  научились воспроизводить звуки системный динами отлично нам сыграть мелодию марио  воспользовавшись магией гугления находим ноты   ноты мелодии марио    далее придется вспомнить курс нотной грамоты выписать каждую ноту   выписанные ноты размерность ми ми ми  ми  соль соль   соль ми  ля си си бемоль ля  соль ми соль ля фа соль  ми  ре си  соль ми диез фа бекар ре диез ми диез  соль диез ля диез  ля  ре  соль фа диез фе бекар ре ми       стоит отметить ввел несколько допущений реальной мелодии играется две ноты одновременно синхронизировать досбокса хотелось поэтому играл одной ноте  вооружившись большим терпением переводим каждую ноту частоты собираем массивы частот длительностей     данной мелодии насчитал ноты стоит заметить задержку двумя соседними нотами выбирал слух получилось немного медленнее оригинале   заключение  заключении хочу сказать работа железом получается интересной написание кучи высокоуровневого кода  кого возникнет желание улучшить мою мелодию написать свое милости прошу комментарии     решили хотите поиграть системном динамике знаете основ нотной грамоты спойлером найти пару хинтов   хинты нотной грамоте    теги        добавить метки хабы ненормальное программирование  компьютерное железо сделай укажите причину минуса автор поработал ошибками  отправить анонимно 